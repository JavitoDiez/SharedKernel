version: '3.8'

services:

    sqlserver:
        image: mcr.microsoft.com/mssql/server:latest
        environment:
            - ACCEPT_EULA=Y
            - SA_PASSWORD=yourStrong(!)Password
            - MSSQL_PID=Developer
        ports:
            - 22220:1433
     
    mongo:
        image: mongo:latest
        ports:
            - 22221:27017

    redis:
        image: redis:latest
        ports:
            - 22222:6379

    rabbitmq:
        image: rabbitmq:latest
        environment:
            - RABBITMQ_DEFAULT_USER=user
            - RABBITMQ_DEFAULT_PASS=password
        ports:
            - 22223:5672

    smtp:
        image: ixdotai/smtp:latest
        ports:
            - 127.0.0.1:22224:25
        environment:
            - SMARTHOST_ADDRESS=smtp.sendgrid.net
            - SMARTHOST_PORT=587
            - SMARTHOST_USER=apikey
            - SMARTHOST_PASSWORD=SG.blahblahblahblahWoSpQodvLakqXQfxo
            - SMARTHOST_ALIASES=*.sendgrid.net
 
    activemq:
        image: islandora/activemq:main
        ports:
            - 8170:8161
            - 22225:61616

    postgres:
        image: postgres:latest
        environment:
            POSTGRES_DB: postgres_testing
            POSTGRES_USER: admin
            POSTGRES_PASSWORD: password
        ports:
            - 22226:5432

    postgis:
        image: postgis/postgis:latest
        environment:
            POSTGRES_DB: postgis_testing
            POSTGRES_USER: admin
            POSTGRES_PASSWORD: password
        ports:
            - 22227:5432

    elasticsearch:
        image: elasticsearch:8.9.2
        environment:
            - discovery.type=single-node
            - "ES_JAVA_OPTS=-Xms512m -Xmx512m"
            - ELASTIC_USER=admin
            - ELASTIC_PASSWORD=password
            - bootstrap.memory_lock=true
            - xpack.security.enabled=false
            - xpack.security.http.ssl.enabled=false
            # - xpack.security.http.ssl.key=certs/es01/es01.key
            # - xpack.security.http.ssl.certificate=certs/es01/es01.crt
            # - xpack.security.http.ssl.certificate_authorities=certs/ca/ca.crt
            - xpack.security.transport.ssl.enabled=false
            # - xpack.security.transport.ssl.key=certs/es01/es01.key
            # - xpack.security.transport.ssl.certificate=certs/es01/es01.crt
            # - xpack.security.transport.ssl.certificate_authorities=certs/ca/ca.crt
            # - xpack.security.transport.ssl.verification_mode=certificate
            # - xpack.license.self_generated.type=${LICENSE}
        mem_limit: 1g
        ulimits:
            memlock:
                soft: -1
                hard: -1
        ports:
            - 22228:9200
            - 22229:9300

    # elasticsearch1:
    #     image: elasticsearch:8.9.2
    #     environment:
    #         - node.name=es-node-1
    #         - cluster.name=my-cluster
    #         - discovery.seed_hosts=elasticsearch2,elasticsearch3
    #         - cluster.initial_master_nodes=es-node-1,es-node-2,es-node-3
    #         - "ES_JAVA_OPTS=-Xms512m -Xmx512m"
    #         - ELASTIC_USER=admin
    #         - ELASTIC_PASSWORD=password
    #         - bootstrap.memory_lock=true
    #         - xpack.security.enabled=false
    #         - xpack.security.http.ssl.enabled=false
    #         - xpack.security.transport.ssl.enabled=false
    #     mem_limit: 1g
    #     ulimits:
    #         memlock:
    #             soft: -1
    #             hard: -1
    #     ports:
    #         - 22228:9200
    #         - 22229:9300

    # elasticsearch2:
    #     image: elasticsearch:8.9.2
    #     environment:
    #         - node.name=es-node-2
    #         - cluster.name=my-cluster
    #         - discovery.seed_hosts=elasticsearch1,elasticsearch3
    #         - cluster.initial_master_nodes=es-node-1,es-node-2,es-node-3
    #         - "ES_JAVA_OPTS=-Xms512m -Xmx512m"
    #         - ELASTIC_USER=admin
    #         - ELASTIC_PASSWORD=password
    #         - bootstrap.memory_lock=true
    #         - xpack.security.enabled=false
    #         - xpack.security.http.ssl.enabled=false
    #         - xpack.security.transport.ssl.enabled=false
    #     mem_limit: 1g
    #     ulimits:
    #         memlock:
    #             soft: -1
    #             hard: -1
    #     ports:
    #         - 22230:9200
    #         - 22231:9300

    # elasticsearch3:
    #     image: elasticsearch:8.9.2
    #     environment:
    #         - node.name=es-node-3
    #         - cluster.name=my-cluster
    #         - discovery.seed_hosts=elasticsearch1,elasticsearch2
    #         - cluster.initial_master_nodes=es-node-1,es-node-2,es-node-3
    #         - "ES_JAVA_OPTS=-Xms512m -Xmx512m"
    #         - ELASTIC_USER=admin
    #         - ELASTIC_PASSWORD=password
    #         - bootstrap.memory_lock=true
    #         - xpack.security.enabled=false
    #         - xpack.security.http.ssl.enabled=false
    #         - xpack.security.transport.ssl.enabled=false
    #     mem_limit: 1g
    #     ulimits:
    #         memlock:
    #             soft: -1
    #             hard: -1
    #     ports:
    #         - 22232:9200
    #         - 22233:9300
